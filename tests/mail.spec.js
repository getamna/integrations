"use strict";var __awaiter=this&&this.__awaiter||function(e,i,o,t){return new(o||(o=Promise))((function(a,c){function r(e){try{l(t.next(e))}catch(e){c(e)}}function u(e){try{l(t.throw(e))}catch(e){c(e)}}function l(e){var i;e.done?a(e.value):(i=e.value,i instanceof o?i:new o((function(e){e(i)}))).then(r,u)}l((t=t.apply(e,i||[])).next())}))};Object.defineProperty(exports,"__esModule",{value:!0});const chai_1=require("chai");require("mocha");const services_1=require("../services"),common_1=require("./common"),mailer=common_1.Integrations.getMailService(services_1.MailServiceType.Microsoft),gmailer=common_1.Integrations.getMailService(services_1.MailServiceType.Google);let outlookId="",gmailId="",outlookQuery="",gmailQuery="";describe("Outlook Mail Service",()=>{it("Send outlook mail",()=>__awaiter(void 0,void 0,void 0,(function*(){const e={to:[],cc:[],bcc:[],subject:"buy me food",body:"wokring?"};outlookQuery=e.subject;yield mailer.send(e)}))).timeout(5e3),it("Search message by query",()=>__awaiter(void 0,void 0,void 0,(function*(){const e=yield mailer.searchMail(outlookQuery,25);chai_1.expect(e[0].subject).to.equal(outlookQuery),outlookId=e[0].id}))).timeout(5e3),it("Get mail by Id",()=>__awaiter(void 0,void 0,void 0,(function*(){const e=yield mailer.getMessage(outlookId);chai_1.expect(e.subject).to.equals(outlookQuery)})))}),describe("Gmail Service",()=>{it("Send gmail",()=>__awaiter(void 0,void 0,void 0,(function*(){const e={to:["hxi170730@utdallas.edu"],cc:[],bcc:[],subject:"buy me food",body:"i got food"};gmailQuery=e.subject,gmailId=yield gmailer.send(e)}))).timeout(5e3),it("Search gmail by query",()=>__awaiter(void 0,void 0,void 0,(function*(){const e=yield gmailer.searchMail(gmailQuery,25);chai_1.expect(e[0].subject).to.equals(gmailQuery)}))),it("Get mail by Id",()=>__awaiter(void 0,void 0,void 0,(function*(){yield gmailer.getMessage(gmailId)})))});