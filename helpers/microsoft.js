"use strict";var __importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r};Object.defineProperty(exports,"__esModule",{value:!0});const rrule_1=__importStar(require("rrule"));function convertToEvent(e){const{id:r,organizer:t,subject:a,start:n,end:s,location:o,attendees:i,onlineMeeting:c,body:l,webLink:d,isCancelled:u}=e;return{id:r,organizerName:t.emailAddress.name,subject:a,status:u?"cancelled":"confirmed",startTime:new Date(n.dateTime),endTime:new Date(s.dateTime),location:o.displayName,attendees:i.map(e=>({name:e.emailAddress.name,email:e.emailAddress.address,reponse:e.status.response})),meetingLink:c?c.joinUrl:"",content:l.content,organizer:{name:t.emailAddress.name,email:t.emailAddress.address},recurrence:getRecurrenceDetails(e),calendarLink:d}}function convertToMessageArray(e){const r=[];return e.hitsContainers.forEach(e=>{e.hits.forEach(e=>{r.push({id:e.hitId,body:e.summary,subject:e.resource.subject,from:{name:e.resource.sender.emailAddress.name,email:e.resource.sender.emailAddress.address},to:[]})})}),r}function convertToEventsArray(e){const r=[];return e.forEach(e=>{const{organizer:t,subject:a,start:n,end:s,location:o,attendees:i,onlineMeeting:c,body:l,id:d,webLink:u,isCancelled:m}=e;r.push({id:d,organizerName:t.emailAddress.name,status:m?"cancelled":"confirmed",subject:a,startTime:new Date(n.dateTime),endTime:new Date(s.dateTime),location:o.displayName,attendees:i.map(e=>({name:e.emailAddress.name,email:e.emailAddress.address,reponse:e.status.response})),meetingLink:c?c.joinUrl:"",content:l.content,organizer:{name:t.emailAddress.name,email:t.emailAddress.address},recurrence:getRecurrenceDetails(e),calendarLink:u})}),r}function getRecurrenceDetails(e){const{recurrence:r}=e;if(!r)return[];const{pattern:t,range:a}=r,{interval:n}=t;let s=rrule_1.Frequency.DAILY;switch(t.type){case"daily":s=rrule_1.Frequency.DAILY;break;case"weekly":s=rrule_1.Frequency.WEEKLY;break;case"absoluteMonthly":s=rrule_1.Frequency.MONTHLY;break;case"relativeMonthly":console.error("Currently no support for relative monthly recurrence.");break;case"absoluteYearly":s=rrule_1.Frequency.YEARLY;break;case"relativeYearly":console.error("Currently no support for relative monthly recurrence.")}return console.log(typeof e.start.dateTime),[new rrule_1.default({freq:s,interval:n,byweekday:t.daysOfWeek.map(e=>{switch(e){case"sunday":return rrule_1.default.SU;case"monday":return rrule_1.default.MO;case"tuesday":return rrule_1.default.TU;case"wednesday":return rrule_1.default.WE;case"thursday":return rrule_1.default.TH;case"friday":return rrule_1.default.FR;case"saturday":return rrule_1.default.SA}}),dtstart:new Date(e.start.dateTime),until:"endDate"===a.type?new Date(Date.parse(a.endDate)):void 0}).toString()]}exports.convertToEvent=convertToEvent,exports.convertToMessageArray=convertToMessageArray,exports.convertToEventsArray=convertToEventsArray,exports.getRecurrenceDetails=getRecurrenceDetails;